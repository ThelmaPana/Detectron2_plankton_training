# Detectron2_plankton_training

Code to train [Detectron2](https://github.com/facebookresearch/detectron2) on ISIIS plankton images.

Thelma Panaiotis PhD

Laboratoire d’Océanographie de Villefranche (UMR 7093)

# Repository organisation

## Folders

- `lib` contains scripts called when needed
- `data` contains data
    - `data/manual_stack/` contains manual images segmentation in `.psd` 
    - `data/ecotaxa_export.csv` contains EcoTaxa export (particles properties and classification) generated by `00.extract_ecotaxa_objects.R`
    - `data/detectron2_dataset/` contains frames generated by `01.prepare_dataset_detectron2.py` in `train`, `valid` and `test` subfolders
- `output` contains Detectron2 training outputs

## Scripts
Scripts order is self-explanatory. 

- `00.extract_ecotaxa_objects.R` run extraction from EcoTaxa
- `01.prepare_dataset_detectron2.py` prepare the dataset for Detectron2
- `02.detectron2_plankton_training.py` train and evaluate Detectron2 model
- `03.inspect_detectron2_plankton_training.ipynb` inspect results

# Useful ressources and references
- Detectron2 on github: https://github.com/facebookresearch/detectron2
- Detectron2 documentation: https://detectron2.readthedocs.io/en/latest/index.html
- Detectron2 balloons tutorial used as a baseline: https://colab.research.google.com/drive/16jcaJoc6bCFAQ96jDe2HwtXj7BMD_-m5
- How to use Detectron2 models: https://detectron2.readthedocs.io/en/latest/tutorials/models.html
- Training on Detectron2 with a validation set: https://medium.com/@apofeniaco/training-on-detectron2-with-a-validation-set-and-plot-loss-on-it-to-avoid-overfitting-6449418fbf4e
- How to build custom datasets for Detectron2: https://detectron2.readthedocs.io/en/latest/tutorials/datasets.html
- Create COCO Annotations From Scratch: https://www.immersivelimit.com/tutorials/create-coco-annotations-from-scratch
